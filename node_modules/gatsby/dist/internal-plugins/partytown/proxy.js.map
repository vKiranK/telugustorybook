{"version":3,"sources":["../../../src/internal-plugins/partytown/proxy.ts"],"names":["thirdPartyProxyPath","partytownProxy","partytownProxiedURLs","req","URL","query","url","origin","filter","some","proxyReqPathResolver","pathname","search"],"mappings":";;;;;;;;AAAA;;AAGO,MAAMA,mBAAmB,GAAI,sBAA7B;;;AAEA,SAASC,cAAT,CACLC,oBADK,EAEW;AAChB,SAAO,+BAAMC,GAAG,IAAI,IAAIC,GAAJ,CAAQD,GAAG,CAACE,KAAJ,CAAUC,GAAlB,EAAiCC,MAA9C,EAAgE;AACrEC,IAAAA,MAAM,EAAEL,GAAG,IAAID,oBAAoB,CAACO,IAArB,CAA0BH,GAAG;AAAA;;AAAA,aAAI,eAAAH,GAAG,CAACE,KAAJ,0DAAWC,GAAX,MAAmBA,GAAvB;AAAA,KAA7B,CADsD;AAErEI,IAAAA,oBAAoB,EAAEP,GAAG,IAAI;AAAA;;AAC3B,YAAM;AAAEQ,QAAAA,QAAQ,GAAI,EAAd;AAAiBC,QAAAA,MAAM,GAAI;AAA3B,UAAiC,IAAIR,GAAJ,gBAAQD,GAAG,CAACE,KAAZ,gDAAQ,YAAWC,GAAnB,CAAvC;AACA,aAAOK,QAAQ,GAAGC,MAAlB;AACD;AALoE,GAAhE,CAAP;AAOD","sourcesContent":["import proxy from \"express-http-proxy\"\nimport type { RequestHandler } from \"express\"\n\nexport const thirdPartyProxyPath = `/__third-party-proxy`\n\nexport function partytownProxy(\n  partytownProxiedURLs: Array<string>\n): RequestHandler {\n  return proxy(req => new URL(req.query.url as string).origin as string, {\n    filter: req => partytownProxiedURLs.some(url => req.query?.url === url),\n    proxyReqPathResolver: req => {\n      const { pathname = ``, search = `` } = new URL(req.query?.url as string)\n      return pathname + search\n    },\n  })\n}\n"],"file":"proxy.js"}